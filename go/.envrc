
#!/usr/bin/env bash

# Load .env if exists, otherwise create from sample
if [ -f ".env" ]; then
  dotenv .env
else
  cp .env.sample .env
  dotenv .env
fi

# Get required environment variables from sample (excluding empty lines and comments)
required_envs=$(grep -v '^#' .env.sample | grep -v '^$' | cut -d '=' -f 1)

# Check all required variables are set (skip empty values for LINE variables in dev)
for var in $required_envs; do
  if [ -z "${!var}" ] && [[ "$var" != "LINE_"* ]]; then
    echo "ERROR: Missing environment variable: $var" >&2
    echo "Please set $var in .env file" >&2
    exit 1
  fi
done